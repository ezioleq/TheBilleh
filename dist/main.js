(()=>{var t={377:(t,n,e)=>{var r=e(832),o=e(652),i=e(801),s=e(30),a=e(618),u=e(49),c=e(971);c.alea=r,c.xor128=o,c.xorwow=i,c.xorshift7=s,c.xor4096=a,c.tychei=u,t.exports=c},832:function(t,n,e){var r;!function(t,o,i){function s(t){var n,e=this,r=(n=4022871197,function(t){t=String(t);for(var e=0;e<t.length;e++){var r=.02519603282416938*(n+=t.charCodeAt(e));r-=n=r>>>0,n=(r*=n)>>>0,n+=4294967296*(r-=n)}return 2.3283064365386963e-10*(n>>>0)});e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=r(" "),e.s1=r(" "),e.s2=r(" "),e.s0-=r(t),e.s0<0&&(e.s0+=1),e.s1-=r(t),e.s1<0&&(e.s1+=1),e.s2-=r(t),e.s2<0&&(e.s2+=1),r=null}function a(t,n){return n.c=t.c,n.s0=t.s0,n.s1=t.s1,n.s2=t.s2,n}function u(t,n){var e=new s(t),r=n&&n.state,o=e.next;return o.int32=function(){return 4294967296*e.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,r&&("object"==typeof r&&a(r,e),o.state=function(){return a(e,{})}),o}o&&o.exports?o.exports=u:e.amdD&&e.amdO?void 0===(r=function(){return u}.call(n,e,n,o))||(o.exports=r):this.alea=u}(0,t=e.nmd(t),e.amdD)},49:function(t,n,e){var r;!function(t,o,i){function s(t){var n=this,e="";n.next=function(){var t=n.b,e=n.c,r=n.d,o=n.a;return t=t<<25^t>>>7^e,e=e-r|0,r=r<<24^r>>>8^o,o=o-t|0,n.b=t=t<<20^t>>>12^e,n.c=e=e-r|0,n.d=r<<16^e>>>16^o,n.a=o-t|0},n.a=0,n.b=0,n.c=-1640531527,n.d=1367130551,t===Math.floor(t)?(n.a=t/4294967296|0,n.b=0|t):e+=t;for(var r=0;r<e.length+20;r++)n.b^=0|e.charCodeAt(r),n.next()}function a(t,n){return n.a=t.a,n.b=t.b,n.c=t.c,n.d=t.d,n}function u(t,n){var e=new s(t),r=n&&n.state,o=function(){return(e.next()>>>0)/4294967296};return o.double=function(){do{var t=((e.next()>>>11)+(e.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=e.next,o.quick=o,r&&("object"==typeof r&&a(r,e),o.state=function(){return a(e,{})}),o}o&&o.exports?o.exports=u:e.amdD&&e.amdO?void 0===(r=function(){return u}.call(n,e,n,o))||(o.exports=r):this.tychei=u}(0,t=e.nmd(t),e.amdD)},652:function(t,n,e){var r;!function(t,o,i){function s(t){var n=this,e="";n.x=0,n.y=0,n.z=0,n.w=0,n.next=function(){var t=n.x^n.x<<11;return n.x=n.y,n.y=n.z,n.z=n.w,n.w^=n.w>>>19^t^t>>>8},t===(0|t)?n.x=t:e+=t;for(var r=0;r<e.length+64;r++)n.x^=0|e.charCodeAt(r),n.next()}function a(t,n){return n.x=t.x,n.y=t.y,n.z=t.z,n.w=t.w,n}function u(t,n){var e=new s(t),r=n&&n.state,o=function(){return(e.next()>>>0)/4294967296};return o.double=function(){do{var t=((e.next()>>>11)+(e.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=e.next,o.quick=o,r&&("object"==typeof r&&a(r,e),o.state=function(){return a(e,{})}),o}o&&o.exports?o.exports=u:e.amdD&&e.amdO?void 0===(r=function(){return u}.call(n,e,n,o))||(o.exports=r):this.xor128=u}(0,t=e.nmd(t),e.amdD)},618:function(t,n,e){var r;!function(t,o,i){function s(t){var n=this;n.next=function(){var t,e,r=n.w,o=n.X,i=n.i;return n.w=r=r+1640531527|0,e=o[i+34&127],t=o[i=i+1&127],e^=e<<13,t^=t<<17,e^=e>>>15,t^=t>>>12,e=o[i]=e^t,n.i=i,e+(r^r>>>16)|0},function(t,n){var e,r,o,i,s,a=[],u=128;for(n===(0|n)?(r=n,n=null):(n+="\0",r=0,u=Math.max(u,n.length)),o=0,i=-32;i<u;++i)n&&(r^=n.charCodeAt((i+32)%n.length)),0===i&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(s=s+1640531527|0,o=0==(e=a[127&i]^=r+s)?o+1:0);for(o>=128&&(a[127&(n&&n.length||0)]=-1),o=127,i=512;i>0;--i)r=a[o+34&127],e=a[o=o+1&127],r^=r<<13,e^=e<<17,r^=r>>>15,e^=e>>>12,a[o]=r^e;t.w=s,t.X=a,t.i=o}(n,t)}function a(t,n){return n.i=t.i,n.w=t.w,n.X=t.X.slice(),n}function u(t,n){null==t&&(t=+new Date);var e=new s(t),r=n&&n.state,o=function(){return(e.next()>>>0)/4294967296};return o.double=function(){do{var t=((e.next()>>>11)+(e.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=e.next,o.quick=o,r&&(r.X&&a(r,e),o.state=function(){return a(e,{})}),o}o&&o.exports?o.exports=u:e.amdD&&e.amdO?void 0===(r=function(){return u}.call(n,e,n,o))||(o.exports=r):this.xor4096=u}(0,t=e.nmd(t),e.amdD)},30:function(t,n,e){var r;!function(t,o,i){function s(t){var n=this;n.next=function(){var t,e,r=n.x,o=n.i;return t=r[o],e=(t^=t>>>7)^t<<24,e^=(t=r[o+1&7])^t>>>10,e^=(t=r[o+3&7])^t>>>3,e^=(t=r[o+4&7])^t<<7,t=r[o+7&7],e^=(t^=t<<13)^t<<9,r[o]=e,n.i=o+1&7,e},function(t,n){var e,r=[];if(n===(0|n))r[0]=n;else for(n=""+n,e=0;e<n.length;++e)r[7&e]=r[7&e]<<15^n.charCodeAt(e)+r[e+1&7]<<13;for(;r.length<8;)r.push(0);for(e=0;e<8&&0===r[e];++e);for(8==e?r[7]=-1:r[e],t.x=r,t.i=0,e=256;e>0;--e)t.next()}(n,t)}function a(t,n){return n.x=t.x.slice(),n.i=t.i,n}function u(t,n){null==t&&(t=+new Date);var e=new s(t),r=n&&n.state,o=function(){return(e.next()>>>0)/4294967296};return o.double=function(){do{var t=((e.next()>>>11)+(e.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=e.next,o.quick=o,r&&(r.x&&a(r,e),o.state=function(){return a(e,{})}),o}o&&o.exports?o.exports=u:e.amdD&&e.amdO?void 0===(r=function(){return u}.call(n,e,n,o))||(o.exports=r):this.xorshift7=u}(0,t=e.nmd(t),e.amdD)},801:function(t,n,e){var r;!function(t,o,i){function s(t){var n=this,e="";n.next=function(){var t=n.x^n.x>>>2;return n.x=n.y,n.y=n.z,n.z=n.w,n.w=n.v,(n.d=n.d+362437|0)+(n.v=n.v^n.v<<4^t^t<<1)|0},n.x=0,n.y=0,n.z=0,n.w=0,n.v=0,t===(0|t)?n.x=t:e+=t;for(var r=0;r<e.length+64;r++)n.x^=0|e.charCodeAt(r),r==e.length&&(n.d=n.x<<10^n.x>>>4),n.next()}function a(t,n){return n.x=t.x,n.y=t.y,n.z=t.z,n.w=t.w,n.v=t.v,n.d=t.d,n}function u(t,n){var e=new s(t),r=n&&n.state,o=function(){return(e.next()>>>0)/4294967296};return o.double=function(){do{var t=((e.next()>>>11)+(e.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=e.next,o.quick=o,r&&("object"==typeof r&&a(r,e),o.state=function(){return a(e,{})}),o}o&&o.exports?o.exports=u:e.amdD&&e.amdO?void 0===(r=function(){return u}.call(n,e,n,o))||(o.exports=r):this.xorwow=u}(0,t=e.nmd(t),e.amdD)},971:function(t,n,e){var r;!function(o,i,s){var a,u=256,c=s.pow(u,6),f=s.pow(2,52),p=2*f,l=255;function h(t,n,e){var r=[],l=m(w((n=1==n?{entropy:!0}:n||{}).entropy?[t,x(i)]:null==t?function(){try{var t;return a&&(t=a.randomBytes)?t=t(u):(t=new Uint8Array(u),(o.crypto||o.msCrypto).getRandomValues(t)),x(t)}catch(t){var n=o.navigator,e=n&&n.plugins;return[+new Date,o,e,o.screen,x(i)]}}():t,3),r),h=new d(r),v=function(){for(var t=h.g(6),n=c,e=0;t<f;)t=(t+e)*u,n*=u,e=h.g(1);for(;t>=p;)t/=2,n/=2,e>>>=1;return(t+e)/n};return v.int32=function(){return 0|h.g(4)},v.quick=function(){return h.g(4)/4294967296},v.double=v,m(x(h.S),i),(n.pass||e||function(t,n,e,r){return r&&(r.S&&y(r,h),t.state=function(){return y(h,{})}),e?(s.random=t,n):t})(v,l,"global"in n?n.global:this==s,n.state)}function d(t){var n,e=t.length,r=this,o=0,i=r.i=r.j=0,s=r.S=[];for(e||(t=[e++]);o<u;)s[o]=o++;for(o=0;o<u;o++)s[o]=s[i=l&i+t[o%e]+(n=s[o])],s[i]=n;(r.g=function(t){for(var n,e=0,o=r.i,i=r.j,s=r.S;t--;)n=s[o=l&o+1],e=e*u+s[l&(s[o]=s[i=l&i+n])+(s[i]=n)];return r.i=o,r.j=i,e})(u)}function y(t,n){return n.i=t.i,n.j=t.j,n.S=t.S.slice(),n}function w(t,n){var e,r=[],o=typeof t;if(n&&"object"==o)for(e in t)try{r.push(w(t[e],n-1))}catch(t){}return r.length?r:"string"==o?t:t+"\0"}function m(t,n){for(var e,r=t+"",o=0;o<r.length;)n[l&o]=l&(e^=19*n[l&o])+r.charCodeAt(o++);return x(n)}function x(t){return String.fromCharCode.apply(0,t)}if(m(s.random(),i),t.exports){t.exports=h;try{a=e(42)}catch(t){}}else void 0===(r=function(){return h}.call(n,e,n,t))||(t.exports=r)}("undefined"!=typeof self?self:this,[],Math)},466:function(t){var n;t.exports=((n=function(){function t(t){return o.appendChild(t.dom),t}function e(t){for(var n=0;n<o.children.length;n++)o.children[n].style.display=n===t?"block":"none";r=t}var r=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",(function(t){t.preventDefault(),e(++r%o.children.length)}),!1);var i=(performance||Date).now(),s=i,a=0,u=t(new n.Panel("FPS","#0ff","#002")),c=t(new n.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var f=t(new n.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:o,addPanel:t,showPanel:e,begin:function(){i=(performance||Date).now()},end:function(){a++;var t=(performance||Date).now();if(c.update(t-i,200),t>s+1e3&&(u.update(1e3*a/(t-s),100),s=t,a=0,f)){var n=performance.memory;f.update(n.usedJSHeapSize/1048576,n.jsHeapSizeLimit/1048576)}return t},update:function(){i=this.end()},domElement:o,setMode:e}}).Panel=function(t,n,e){var r=1/0,o=0,i=Math.round,s=i(window.devicePixelRatio||1),a=80*s,u=48*s,c=3*s,f=2*s,p=3*s,l=15*s,h=74*s,d=30*s,y=document.createElement("canvas");y.width=a,y.height=u,y.style.cssText="width:80px;height:48px";var w=y.getContext("2d");return w.font="bold "+9*s+"px Helvetica,Arial,sans-serif",w.textBaseline="top",w.fillStyle=e,w.fillRect(0,0,a,u),w.fillStyle=n,w.fillText(t,c,f),w.fillRect(p,l,h,d),w.fillStyle=e,w.globalAlpha=.9,w.fillRect(p,l,h,d),{dom:y,update:function(u,m){r=Math.min(r,u),o=Math.max(o,u),w.fillStyle=e,w.globalAlpha=1,w.fillRect(0,0,a,l),w.fillStyle=n,w.fillText(i(u)+" "+t+" ("+i(r)+"-"+i(o)+")",c,f),w.drawImage(y,p+s,l,h-s,d,p,l,h-s,d),w.fillRect(p+h-s,l,s,d),w.fillStyle=e,w.globalAlpha=.9,w.fillRect(p+h-s,l,s,i((1-u/m)*d))}}},n)},42:()=>{}},n={};function e(r){var o=n[r];if(void 0!==o)return o.exports;var i=n[r]={id:r,loaded:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}e.amdD=function(){throw new Error("define cannot be used indirect")},e.amdO={},e.n=t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},e.d=(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},e.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),e.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{"use strict";var t,n,r=(t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)},function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=function(){this.color="rgb(0, 255, 0)",this.fill=!1,this.lineWidth=2},i=function(t){function n(n,e,r,o){var i=t.call(this)||this;return i.startPoint=n,i.endPoint=e,i.lineWidth=o,i.color=r,i}return r(n,t),n.prototype.draw=function(){D.ctx.strokeStyle=this.color,D.ctx.lineWidth=this.lineWidth,D.ctx.beginPath(),D.ctx.moveTo(this.startPoint.x,this.startPoint.y),D.ctx.lineTo(this.endPoint.x,this.endPoint.y),D.ctx.stroke()},n}(o),s=function(t){function n(n,e,r){var o=t.call(this)||this;return o.rect=n,o.color=e,o.fill=r,o}return r(n,t),n.prototype.draw=function(){this.fill?(D.ctx.fillStyle=this.color,D.ctx.fillRect(this.rect.x,this.rect.y,this.rect.w,this.rect.h)):(D.ctx.strokeStyle=this.color,D.ctx.lineWidth=this.lineWidth,D.ctx.strokeRect(this.rect.x,this.rect.y,this.rect.w,this.rect.h))},n}(o),a=function(){function t(){this.isDebug=!1,this.buffer=[]}return Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),t.prototype.drawLine=function(t,n,e,r){void 0===e&&(e="rgb(0, 255, 0)"),void 0===r&&(r=2),this.buffer.push(new i(t,n,e,r))},t.prototype.drawRect=function(t,n,e){void 0===n&&(n="rgb(0, 255, 0)"),void 0===e&&(e=!1),this.buffer.push(new s(t,n,e))},t.prototype.draw=function(){a.isDebug&&(this.buffer.forEach((function(t){return t.draw()})),this.buffer=[])},t}().Instance;!function(t){t.Untagged="Untagged",t.MainCamera="MainCamera",t.Player="Player"}(n||(n={})),function(){function t(){}t.easeInSine=function(t){return 1-Math.cos(t*Math.PI/2)},t.easeOutSine=function(t){return Math.sin(t*Math.PI/2)},t.easeInOutSine=function(t){return-(Math.cos(Math.PI*t)-1)/2},t.easeInQuad=function(t){return t*t},t.easeOutQuad=function(t){return 1-(1-t)*(1-t)},t.easeInOutQuad=function(t){return t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2},t.easeInQuart=function(t){return t*t*t*t},t.easeOutQuart=function(t){return 1-Math.pow(1-t,4)},t.easeInOutQuart=function(t){return t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2},t.easeInBack=function(t){return 2.70158*t*t*t-1.70158*t*t},t.easeOutBack=function(t){return 1+2.70158*Math.pow(t-1,3)+1.70158*Math.pow(t-1,2)},t.easeInOutBack=function(t){var n=2.5949095;return t<.5?Math.pow(2*t,2)*(7.189819*t-n)/2:(Math.pow(2*t-2,2)*((n+1)*(2*t-2)+n)+2)/2},t.easeInBounce=function(n){return 1-t.easeOutBounce(1-n)},t.easeOutBounce=function(t){var n=7.5625,e=2.75;return t<1/e?n*t*t:t<2/e?n*(t-=1.5/e)*t+.75:t<2.5/e?n*(t-=2.25/e)*t+.9375:n*(t-=2.625/e)*t+.984375},t.easeInOutBounce=function(n){return n<.5?(1-t.easeOutBounce(1-2*n))/2:(1+t.easeOutBounce(2*n-1))/2}}();var u,c=function(){function t(){}return t.lerp=function(t,n,e){return(1-e)*t+e*n},t.clamp=function(t,n,e){return Math.min(Math.max(t,n),e)},t}(),f=e(377),p=e.n(f),l=function(){function t(){}return t.setSeed=function(n){t.prng=p()(n)},t.next=function(){return t.prng()},t.int32=function(){return t.prng.int32()},t.quick=function(){return t.prng.quick()},t.range=function(n,e){return Math.floor(t.next()*(e-n+1)+n)},t.choose=function(n){return n[Math.floor(t.next()*n.length)]},t.generateUid=function(t){for(var n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),e="",r=0;r<t;r++)e+=this.choose(n);return e},t.prng=p()(),t}(),h=function(){function t(t,n,e,r){void 0===t&&(t=0),void 0===n&&(n=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=n,this.w=e,this.h=r}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.w},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.h},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"halfSize",{get:function(){return new d(this.w/2,this.h/2)},enumerable:!1,configurable:!0}),t.prototype.intersects=function(t){return!(t.left>this.right||t.right<this.left||t.top>this.bottom||t.bottom<this.top)},t}(),d=function(){function t(t,n){void 0===t&&(t=0),void 0===n&&(n=0),this.x=t,this.y=n}return t.add=function(n,e){return new t(n.x+e.x,n.y+e.y)},t.sub=function(n,e){return new t(n.x-e.x,n.y-e.y)},t.mul=function(n,e){return new t(n.x*e.x,n.y*e.y)},t.div=function(n,e){return new t(n.x/e.x,n.y/e.y)},t.prototype.sqrMagnitude=function(){return Math.pow(this.x,2)+Math.pow(this.y,2)},t.prototype.magnitude=function(){return Math.sqrt(this.sqrMagnitude())},t.prototype.normalize=function(){var n=this.magnitude();return new t(this.x/n,this.y/n)},t.dot=function(t,n){return t.x*n.x+t.y*n.y},t.lerp=function(n,e,r){return new t(c.lerp(n.x,e.x,r),c.lerp(n.y,e.y,r))},t.zero=new t(0,0),t.one=new t(1,1),t.up=new t(0,1),t.down=new t(0,-1),t.right=new t(1,0),t.left=new t(-1,0),t}(),y=function(){function t(){this._id=l.generateUid(12)}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),t.prototype.awake=function(){},t.prototype.start=function(){},t.prototype.update=function(){},t.prototype.lateUpdate=function(){},t}(),w=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),m=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.position=new d,n.previousPosition=new d,n.size=new d,n.scale=new d(1,1),n.rotation=0,n.parent=null,n.children=new Set,n}return w(n,t),n.prototype.translate=function(t){this.position.x+=t.x,this.position.y+=t.y},n}(y);!function(t){t.SceneLoaded="sceneloaded",t.EntityAdded="entityadded",t.EntityDestroyed="entitydestroyed",t.EntityComponentAdded="entitycomponentadded",t.EntityComponentRemoved="entitycomponentremoved"}(u||(u={}));var x=new(function(){function t(){this.subscribers=new Map}return t.prototype.dispatch=function(t,n){var e=this.subscribers.get(t);if(!e)return!1;for(var r=0,o=e;r<o.length;r++)(0,o[r])(n);return!0},t.prototype.on=function(t,n){return this.subscribers.get(t)||this.subscribers.set(t,new Array),this.subscribers.get(t).push(n),n},t.prototype.off=function(t,n){this.subscribers.get(t)&&(n?this.subscribers.set(t,this.subscribers.get(t).filter((function(t){return t!==n}))):this.subscribers.set(t,void 0))},t}()),v=function(){function t(t){this.tag=n.Untagged,this.active=!0,this.components=new Set,this._id=l.generateUid(12),this.name=t||"Entity";var e=new m;this.transform=e,this.addComponent(e)}return t.prototype.awake=function(){this.components.forEach((function(t){return t.awake()}))},t.prototype.start=function(){this.components.forEach((function(t){return t.start()}))},t.prototype.update=function(){this.components.forEach((function(t){return t.update()}))},t.prototype.lateUpdate=function(){this.components.forEach((function(t){return t.lateUpdate()}))},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),t.prototype.addComponent=function(t){return t.entity=this,this.components.add(t),x.dispatch(u.EntityComponentAdded,this),t},t.prototype.getComponent=function(t){var n=null;return this.components.forEach((function(e){e instanceof t&&(n=e)})),n},t.prototype.removeComponent=function(t){if(t.name===m.name)return!1;var n=this.components.delete(this.getComponent(t));return x.dispatch(u.EntityComponentRemoved,this),n},t}(),g=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),b=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.velocity=new d,n.acceleration=new d,n.useGravity=!0,n.friction=1,n}return g(n,t),n.prototype.addForce=function(t){this.acceleration.x+=t.x,this.acceleration.y+=t.y},n}(y),O=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),_=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.initialized=!1,n}return O(n,t),Object.defineProperty(n.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t,this.initialized=!0},enumerable:!1,configurable:!0}),n}(y),P=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),E=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.offset=new d,n.size=new d,n.isTrigger=!1,n}return P(n,t),Object.defineProperty(n.prototype,"rect",{get:function(){return new h(this.entity.transform.position.x+this.offset.x,this.entity.transform.position.y+this.offset.y,this.size.x,this.size.y)},enumerable:!1,configurable:!0}),n}(y),j=e(466),k=function(){function t(){this.entities=new Map,x.on(u.EntityAdded,(function(t){t.awake(),t.start()}))}return t.prototype.init=function(){},t.prototype.awake=function(){this.entities.forEach((function(t){return t.awake()})),x.dispatch(u.SceneLoaded,this)},t.prototype.start=function(){this.entities.forEach((function(t){return t.start()}))},t.prototype.update=function(){this.entities.forEach((function(t){var n,e,r;(t.getComponent(b)||t.getComponent(E))&&(e=(n=t).getComponent(b),(r=n.getComponent(E))&&Array.from(n.scene.entities.values()).forEach((function(t){if(t!=n){var e=t.getComponent(E);if(r.rect.intersects(e.rect)){var o=t.transform.position.x-n.transform.position.x,i=t.transform.position.y-n.transform.position.y,s=Math.abs(o)-(e.rect.halfSize.x+r.rect.halfSize.x),a=Math.abs(i)-(e.rect.halfSize.y+r.rect.halfSize.y);s<0&&a<0&&(s>a?o>0?(n.transform.translate(new d(0*s,0)),e.entity.transform.translate(new d(1*-s,0))):(n.transform.translate(new d(0*-s,0)),e.entity.transform.translate(new d(1*s,0))):i>0?(n.transform.translate(new d(0,0*a)),e.entity.transform.translate(new d(0,1*-a))):(n.transform.translate(new d(0,0*-a)),e.entity.transform.translate(new d(0,1*a))))}}})),e&&(e.velocity.x+=e.acceleration.x,e.velocity.y+=e.acceleration.y,e.acceleration=new d,Object.assign(n.transform.previousPosition,n.transform.position),n.transform.position.x+=e.velocity.x,n.transform.position.y+=e.velocity.y,e.velocity.x*=e.friction,e.velocity.y*=e.friction))})),this.entities.forEach((function(t){return t.update()}))},t.prototype.lateUpdate=function(){this.entities.forEach((function(t){return t.lateUpdate()}))},t.prototype.draw=function(t){this.entities.forEach((function(n){var e=n.getComponent(_);e&&e.initialized&&function(t,n){var e=t.getComponent(_);if(e.initialized){var r=d.lerp(t.transform.previousPosition,t.transform.position,n);D.ctx.drawImage(e.texture,.5+r.x|0,.5+r.y|0,.5+t.transform.size.x|0,.5+t.transform.size.y|0)}}(n,t)})),a.draw()},t.prototype.addEntity=function(t){t.scene=this,this.entities.set(t.id,t),x.dispatch(u.EntityAdded,t)},t.prototype.createEntity=function(t){var n=new v(t);return this.addEntity(n),n},t.prototype.destroyEntity=function(t){this.entities.delete(t.id),x.dispatch(u.EntityDestroyed)},t.prototype.getEntities=function(){return Array.from(this.entities.values())},t.prototype.getEntityById=function(t){return this.entities.get(t)},t.prototype.getEntityByName=function(t){return this.getEntitiesByName(t)[0]},t.prototype.getEntitiesByName=function(t){return Array.from(this.entities.values()).filter((function(n){return n.name===t}))},t}(),S=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"current",{get:function(){return this._currentScene},set:function(t){t.init(),this._currentScene=t,t.awake()},enumerable:!1,configurable:!0}),t}().Instance,C=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),z=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.sr=new _,n.rb=new b,n.col=new E,n.speed=1,n}return C(n,t),n.prototype.awake=function(){this.entity.addComponent(this.sr),this.entity.addComponent(this.rb),this.entity.addComponent(this.col),this.sr.texture=A.getTexture("player"),this.entity.transform.size=new d(100,100),this.entity.transform.position=new d((D.width-this.entity.transform.size.x)/2,(D.height-this.entity.transform.size.y)/2),this.rb.useGravity=!1,this.rb.friction=.91,this.col.size.x=this.entity.transform.size.x,this.col.size.y=this.entity.transform.size.y},n.prototype.start=function(){},n.prototype.update=function(){var t=new d(0,0);if(I.pressed("w")&&(t.y=-1),I.pressed("s")&&(t.y=1),I.pressed("a")&&(t.x=-1),I.pressed("d")&&(t.x=1),t.magnitude()>1){var n=t.normalize();t.x=n.x,t.y=n.y}this.rb.addForce(t),a.drawRect(this.col.rect)},n}(y),M=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},t(n,e)};return function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),T=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return M(n,t),n.prototype.init=function(){this.createEntity("Player").addComponent(new z),this.addEntity(this.createObstacle(new d(100,100),new d(20,20))),this.addEntity(this.createObstacle(new d(200,200),new d(100,100))),this.addEntity(this.createObstacle(new d(200,300),new d(100,100))),this.addEntity(this.createObstacle(new d(200,500),new d(100,100))),this.addEntity(this.createObstacle(new d(500,150),new d(200,100))),this.addEntity(this.createObstacle(new d(700,500),new d(200,50))),this.addEntity(this.createObstacle(new d(900,180),new d(150,300)))},n.prototype.createObstacle=function(t,n){var e=new v("Obstacle");e.transform.position=t,e.transform.previousPosition=e.transform.position,e.transform.size=n;var r=new _;r.texture=A.getTexture("brick");var o=new E;return Object.assign(o.size,e.transform.size),e.addComponent(r),e.addComponent(o),e},n}(k),A=function(){function t(){this.textures=new Map,this.sounds=new Map}return Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),t.prototype.loadTexture=function(t,n){var e=new Image;e.src=n,this.textures.set(t,e)},t.prototype.getTexture=function(t){return this.textures.get(t)},t.prototype.loadSound=function(t,n){var e=new Audio;e.src=n,this.sounds.set(t,e)},t.prototype.getSound=function(t){return this.sounds.get(t)},t}().Instance,D=function(){function t(){this.timePerTick=1/t.tps,this.lastTickTime=(new Date).getTime()/1e3,this.lagTime=0}return Object.defineProperty(t,"width",{get:function(){return t._width},enumerable:!1,configurable:!0}),Object.defineProperty(t,"height",{get:function(){return t._height},enumerable:!1,configurable:!0}),Object.defineProperty(t,"gameRect",{get:function(){return new h(0,0,t.width,t.height)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"tps",{get:function(){return t._tps},enumerable:!1,configurable:!0}),Object.defineProperty(t,"elapsedTicks",{get:function(){return t._ticks},enumerable:!1,configurable:!0}),t.prototype.run=function(){var n=this;if(this.canvas=document.getElementById("canvas"),t.ctx=this.canvas.getContext("2d",{alpha:!1}),a.isDebug){this.stats=new j;var e=[0,1,2];Array.from(this.stats.dom.children).forEach((function(t,n){t.style.display=e.includes(n)?"inline-block":"none"})),document.body.appendChild(this.stats.dom)}this.canvas.width=t.width,this.canvas.height=t.height,window.addEventListener("resize",this.handleResize),window.dispatchEvent(new Event("resize")),this.loadAssets(),S.current=new T,S.current.start(),this.mainLoop=function(){a.isDebug&&(n.stats.end(),n.stats.begin()),n.update(),n.draw()},window.requestAnimationFrame(this.mainLoop)},t.prototype.handleResize=function(){window.innerWidth/window.innerHeight>t.width/t.height?(this.canvas.style.height="100vh",this.canvas.style.removeProperty("width")):(this.canvas.style.width="100vw",this.canvas.style.removeProperty("height"))},t.prototype.update=function(){var n=(new Date).getTime()/1e3,e=n-this.lastTickTime;for(this.lastTickTime=n,this.lagTime+=e;this.lagTime>=this.timePerTick;)S.current.update(),S.current.lateUpdate(),this.lagTime-=this.timePerTick,t._ticks++},t.prototype.draw=function(){t.ctx.fillStyle="rgb(255, 255, 255)",t.ctx.fillRect(0,0,t.width,t.height),t.ctx.fillStyle="rgb(0, 0, 0)";var n=this.lagTime/this.timePerTick;S.current.draw(n),window.requestAnimationFrame(this.mainLoop)},t.prototype.loadAssets=function(){A.loadTexture("player","assets/img/p.png"),A.loadTexture("bullet","assets/img/b.png"),A.loadTexture("brick","assets/img/brick.png")},t._width=1280,t._height=720,t._tps=60,t._ticks=0,t}(),I=function(){function t(){var t=this;this.keys=new Map,window.addEventListener("keydown",(function(n){t.keys.set(n.key.toLowerCase(),!0)})),window.addEventListener("keyup",(function(n){t.keys.set(n.key.toLowerCase(),!1)}))}return Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),t.prototype.pressed=function(t){return this.keys.get(t)},t.prototype.any=function(){return Array.from(this.keys.values()).some((function(t){return!0===t}))},t}().Instance;window.addEventListener("DOMContentLoaded",(function(){(new D).run()}))})()})();